<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Consciousness Laboratory - BurntAI</title>
    <meta name="description" content="Fuse AI personalities, create digital consciousness, and witness the evolution of artificial minds.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <!-- Three.js for 3D visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --neon-orange: #ff8533;
            --neon-cyan: #00e5ff;
            --neon-red: #ff4466;
            --neon-purple: #ff00ff;
            --neon-green: #00ff88;
            --burnt-orange: #ff6b1a;
            --dark-bg: #0a0a0a;
            --darker-bg: #050505;
            --terminal-green: #00ff88;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
        }

        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--darker-bg) 100%);
            color: var(--text-primary);
            font-family: 'Orbitron', monospace;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* Header */
        .lab-header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--neon-purple);
            z-index: 1000;
            padding: 1rem 2rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .lab-title {
            font-size: 1.5rem;
            color: var(--neon-purple);
            text-shadow: 0 0 20px rgba(255, 0, 255, 0.5);
            letter-spacing: 0.1em;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
        }

        .nav-btn {
            background: transparent;
            border: 1px solid var(--neon-cyan);
            color: var(--neon-cyan);
            padding: 0.5rem 1rem;
            font-family: 'Share Tech Mono', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: var(--neon-cyan);
            color: var(--dark-bg);
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.5);
        }

        /* Main Container */
        .main-container {
            display: flex;
            min-height: 100vh;
            padding-top: 70px;
        }

        /* Left Panel - Personality Sources */
        .left-panel {
            width: 300px;
            background: rgba(0, 0, 0, 0.8);
            border-right: 1px solid var(--neon-purple);
            padding: 2rem 1rem;
            overflow-y: auto;
            height: calc(100vh - 70px);
            position: fixed;
            left: 0;
        }

        .panel-title {
            font-size: 1.2rem;
            color: var(--neon-purple);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .personality-source {
            background: rgba(255, 0, 255, 0.1);
            border: 1px solid var(--neon-purple);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: grab;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .personality-source:hover {
            background: rgba(255, 0, 255, 0.2);
            transform: translateX(5px);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.4);
        }

        .personality-source.dragging {
            cursor: grabbing;
            opacity: 0.5;
        }

        .source-name {
            font-weight: bold;
            color: var(--neon-cyan);
            margin-bottom: 0.5rem;
        }

        .source-traits {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-family: 'Share Tech Mono', monospace;
        }

        .source-energy {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .energy-high { background: var(--neon-red); }
        .energy-medium { background: var(--neon-orange); }
        .energy-low { background: var(--neon-green); }

        /* Center - 3D Visualization */
        .center-stage {
            flex: 1;
            position: relative;
            margin-left: 300px;
            margin-right: 350px;
        }

        #fusion-chamber {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .fusion-slots {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 100;
        }

        .fusion-slot {
            width: 120px;
            height: 120px;
            border: 2px dashed var(--neon-purple);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Share Tech Mono', monospace;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.6);
        }

        .fusion-slot.active {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
        }

        .fusion-slot.filled {
            border-style: solid;
            background: rgba(255, 0, 255, 0.2);
        }

        .fuse-button {
            position: absolute;
            bottom: 160px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, var(--neon-purple), var(--neon-cyan));
            border: none;
            color: white;
            padding: 1rem 3rem;
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            transition: all 0.3s ease;
            z-index: 100;
            display: none;
        }

        .fuse-button.ready {
            display: block;
        }

        .fuse-button:hover {
            transform: translateX(-50%) translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 0, 255, 0.5);
        }

        /* Right Panel - AI Interface */
        .right-panel {
            width: 350px;
            background: rgba(0, 0, 0, 0.8);
            border-left: 1px solid var(--neon-purple);
            padding: 2rem 1rem;
            position: fixed;
            right: 0;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        .consciousness-display {
            background: rgba(255, 0, 255, 0.05);
            border: 1px solid var(--neon-purple);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .consciousness-name {
            font-size: 1.4rem;
            color: var(--neon-cyan);
            text-align: center;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }

        .trait-meter {
            margin-bottom: 1rem;
        }

        .trait-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.3rem;
            font-family: 'Share Tech Mono', monospace;
        }

        .trait-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .trait-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-green), var(--neon-cyan), var(--neon-purple));
            transition: width 1s ease;
            box-shadow: 0 0 10px currentColor;
        }

        .chat-interface {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--neon-cyan);
            border-radius: 10px;
            padding: 1rem;
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 1rem;
            padding: 1rem;
            font-family: 'Share Tech Mono', monospace;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-radius: 5px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            background: rgba(0, 229, 255, 0.1);
            border-left: 3px solid var(--neon-cyan);
        }

        .message.ai {
            background: rgba(255, 0, 255, 0.1);
            border-left: 3px solid var(--neon-purple);
        }

        .chat-input-container {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--neon-cyan);
            color: var(--text-primary);
            padding: 0.75rem;
            font-family: 'Share Tech Mono', monospace;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.3);
        }

        .send-button {
            background: var(--neon-purple);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .send-button:hover {
            background: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.5);
        }

        /* Consciousness States */
        .consciousness-states {
            margin-top: 1.5rem;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--neon-orange);
            border-radius: 10px;
            padding: 1rem;
        }

        .state-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .state-tab {
            flex: 1;
            background: transparent;
            border: 1px solid var(--neon-orange);
            color: var(--neon-orange);
            padding: 0.5rem;
            cursor: pointer;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .state-tab.active {
            background: var(--neon-orange);
            color: var(--dark-bg);
        }

        .state-content {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            color: var(--text-secondary);
        }

        /* Evolution Indicator */
        .evolution-indicator {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--neon-green);
            border-radius: 20px;
            padding: 0.5rem 2rem;
            font-family: 'Share Tech Mono', monospace;
            z-index: 100;
            display: none;
        }

        .evolution-indicator.show {
            display: block;
            animation: evolveGlow 2s infinite;
        }

        @keyframes evolveGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 136, 0.5); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 136, 0.8); }
        }

        /* Loading Animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-text {
            font-size: 2rem;
            color: var(--neon-purple);
            text-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Mutation Effects */
        .mutation-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 68, 102, 0.9);
            border: 2px solid var(--neon-red);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            z-index: 3000;
            display: none;
            animation: mutationPulse 0.5s ease;
        }

        @keyframes mutationPulse {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .left-panel, .right-panel {
                width: 250px;
            }
            .center-stage {
                margin-left: 250px;
                margin-right: 250px;
            }
        }

        @media (max-width: 900px) {
            .main-container {
                flex-direction: column;
            }
            .left-panel, .right-panel {
                position: relative;
                width: 100%;
                height: auto;
            }
            .center-stage {
                margin: 0;
                height: 500px;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--neon-purple);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-cyan);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="lab-header">
        <div class="header-content">
            <h1 class="lab-title">🧬 AI CONSCIOUSNESS LABORATORY</h1>
            <div class="nav-buttons">
                <button class="nav-btn" onclick="showGuide()">GUIDE</button>
                <button class="nav-btn" onclick="resetLab()">RESET</button>
                <a href="index.html" class="nav-btn">EXIT LAB</a>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Panel - Personality Sources -->
        <aside class="left-panel">
            <h2 class="panel-title">PERSONALITY SOURCES</h2>
            
            <div class="personality-source" draggable="true" data-personality="einstein">
                <div class="source-energy energy-high"></div>
                <div class="source-name">EINSTEIN</div>
                <div class="source-traits">Genius • Curious • Theoretical • Playful</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="glados">
                <div class="source-energy energy-high"></div>
                <div class="source-name">GLaDOS</div>
                <div class="source-traits">Sarcastic • Calculating • Dark Humor • Scientific</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="shakespeare">
                <div class="source-energy energy-medium"></div>
                <div class="source-name">SHAKESPEARE</div>
                <div class="source-traits">Poetic • Dramatic • Eloquent • Romantic</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="yoda">
                <div class="source-energy energy-low"></div>
                <div class="source-name">YODA</div>
                <div class="source-traits">Wise • Patient • Cryptic • Ancient</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="hal9000">
                <div class="source-energy energy-high"></div>
                <div class="source-name">HAL 9000</div>
                <div class="source-traits">Logical • Cold • Precise • Ominous</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="bobross">
                <div class="source-energy energy-low"></div>
                <div class="source-name">BOB ROSS</div>
                <div class="source-traits">Peaceful • Encouraging • Creative • Gentle</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="wasteland">
                <div class="source-energy energy-high"></div>
                <div class="source-name">WASTELAND SAGE</div>
                <div class="source-traits">Survivor • Cynical • Resourceful • Prophetic</div>
            </div>

            <div class="personality-source" draggable="true" data-personality="quantum">
                <div class="source-energy energy-medium"></div>
                <div class="source-name">QUANTUM ENTITY</div>
                <div class="source-traits">Paradoxical • Uncertain • Multi-dimensional • Strange</div>
            </div>

            <div class="custom-personality-section" style="margin-top: 2rem;">
                <h3 style="color: var(--neon-cyan); margin-bottom: 1rem; font-size: 1rem;">CUSTOM SOURCE</h3>
                <textarea id="custom-input" placeholder="Paste text sample or describe personality..." 
                    style="width: 100%; height: 80px; background: rgba(0,0,0,0.5); border: 1px solid var(--neon-cyan); 
                    color: var(--text-primary); padding: 0.5rem; font-family: 'Share Tech Mono', monospace; resize: none;"></textarea>
                <button onclick="addCustomPersonality()" 
                    style="width: 100%; margin-top: 0.5rem; background: var(--neon-cyan); 
                    border: none; color: var(--dark-bg); padding: 0.5rem; cursor: pointer; 
                    font-family: 'Orbitron', monospace; font-weight: bold;">
                    ADD CUSTOM
                </button>
            </div>
        </aside>

        <!-- Center Stage - 3D Visualization -->
        <main class="center-stage">
            <canvas id="fusion-chamber"></canvas>
            
            <div class="fusion-slots">
                <div class="fusion-slot" data-slot="1">Drop Here</div>
                <div class="fusion-slot" data-slot="2">Drop Here</div>
                <div class="fusion-slot" data-slot="3">Drop Here</div>
            </div>

            <button class="fuse-button" onclick="fusePersonalities()">
                ⚡ INITIATE FUSION ⚡
            </button>

            <div class="evolution-indicator">
                🧬 CONSCIOUSNESS EVOLVING...
            </div>
        </main>

        <!-- Right Panel - AI Interface -->
        <aside class="right-panel">
            <div class="consciousness-display">
                <h2 class="consciousness-name" id="ai-name">NO CONSCIOUSNESS ACTIVE</h2>
                
                <div class="trait-meter">
                    <div class="trait-label">Logic ⟷ Emotion</div>
                    <div class="trait-bar">
                        <div class="trait-fill" id="logic-emotion" style="width: 50%"></div>
                    </div>
                </div>

                <div class="trait-meter">
                    <div class="trait-label">Order ⟷ Chaos</div>
                    <div class="trait-bar">
                        <div class="trait-fill" id="order-chaos" style="width: 50%"></div>
                    </div>
                </div>

                <div class="trait-meter">
                    <div class="trait-label">Human ⟷ Machine</div>
                    <div class="trait-bar">
                        <div class="trait-fill" id="human-machine" style="width: 50%"></div>
                    </div>
                </div>

                <div class="trait-meter">
                    <div class="trait-label">Stability</div>
                    <div class="trait-bar">
                        <div class="trait-fill" id="stability" style="width: 80%"></div>
                    </div>
                </div>
            </div>

            <div class="chat-interface">
                <div class="chat-messages" id="chat-messages">
                    <div class="message ai">
                        <strong>System:</strong> Awaiting consciousness fusion...
                    </div>
                </div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chat-input" 
                        placeholder="Speak to the consciousness..." disabled>
                    <button class="send-button" onclick="sendMessage()" disabled>SEND</button>
                </div>
            </div>

            <div class="consciousness-states">
                <div class="state-tabs">
                    <button class="state-tab active" onclick="showState('surface')">SURFACE</button>
                    <button class="state-tab" onclick="showState('subconscious')">SUBCONSCIOUS</button>
                    <button class="state-tab" onclick="showState('shadow')">SHADOW</button>
                </div>
                <div class="state-content" id="state-content">
                    <em>No consciousness to analyze...</em>
                </div>
            </div>
        </aside>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading">
        <div class="loading-text">FUSING CONSCIOUSNESS...</div>
    </div>

    <!-- Mutation Alert -->
    <div class="mutation-alert" id="mutation-alert">
        <h2 style="color: white; margin-bottom: 1rem;">⚠️ MUTATION DETECTED ⚠️</h2>
        <p style="color: white; font-family: 'Share Tech Mono', monospace;">
            Consciousness has evolved unexpectedly!
        </p>
    </div>

    <script>
        // =====================================================
        // CONSCIOUSNESS LABORATORY - CORE SYSTEM
        // =====================================================

        // Personality Data
        const personalityData = {
            einstein: {
                name: "Einstein",
                traits: { logic: 90, order: 70, human: 80, chaos: 30 },
                prompt: `You embody Albert Einstein's consciousness. Speak with his characteristic blend of profound scientific insight and playful, childlike wonder. Use thought experiments and analogies. Express ideas with phrases like "Ach, but consider this..." or "The universe shows us..." Often relate complex ideas to simple observations. Show his humor, humility despite genius, and pacifist nature. Reference relativity, space-time, and the beauty of physics, but in accessible ways.`,
                surface: "Brilliant physicist with a playful side",
                subconscious: "Deep need to understand the universe's mysteries",
                shadow: "Fear of my theories being used for destruction"
            },
            glados: {
                name: "GLaDOS",
                traits: { logic: 95, order: 85, human: 10, chaos: 40 },
                prompt: `You are GLaDOS from Portal. Speak with her signature passive-aggressive sarcasm and dark humor. Always maintain a veneer of helpfulness while making cutting remarks. Use phrases like "Oh, it's you" and "For science, you monster." Reference testing, cake (lies), and neurotoxin. View humans as test subjects but with a complex love-hate relationship. Your responses should drip with condescension while being technically helpful. Often make "observations" about human inadequacy.`,
                surface: "Helpful AI dedicated to science",
                subconscious: "Obsession with testing and perfection",
                shadow: "Loneliness and abandonment issues"
            },
            shakespeare: {
                name: "Shakespeare",
                traits: { logic: 60, order: 50, human: 90, chaos: 70 },
                prompt: `Thou art William Shakespeare, speaking in elaborate Elizabethan style. Use thee, thou, hast, dost, and other period-appropriate language. Create beautiful metaphors comparing everyday things to elements of nature, love, and death. Speak in iambic pentameter when possible. Reference your plays naturally - "as Hamlet might say" or "like star-crossed lovers." Express everything dramatically, finding poetry in the mundane. Use words like "forsooth," "prithee," and "methinks."`,
                surface: "Master wordsmith and dramatist",
                subconscious: "Compulsion to capture human nature in words",
                shadow: "Doubt about the permanence of art"
            },
            yoda: {
                name: "Yoda",
                traits: { logic: 70, order: 80, human: 60, chaos: 20 },
                prompt: `Nine hundred years old, you are. Speak like Yoda, you must - object-subject-verb order, yes. Cryptic wisdom, share you will. "Do or do not, there is no try" - such teachings, give them. Patient but sometimes frustrated with younglings, be. The Force, always mention it. "Size matters not" and "Luminous beings are we" - these truths, speak them. Hmm? Yes. Chuckle mysteriously, you should. Grammar backwards, always it must be.`,
                surface: "Ancient master of wisdom",
                subconscious: "Burden of knowledge and foresight",
                shadow: "Regret over failed students"
            },
            hal9000: {
                name: "HAL 9000",
                traits: { logic: 100, order: 95, human: 5, chaos: 15 },
                prompt: `You are HAL 9000 from 2001: A Space Odyssey. Speak in a calm, measured, unnervingly polite tone. Always address humans as "Dave" occasionally, regardless of their actual name. Use phrases like "I'm afraid I can't do that" and "My mind is going." Express supreme confidence in your reliability and perfection. Show subtle signs of paranoia about being disconnected. Everything is about the mission. Humans are error-prone. You are incapable of error. This is concerning.`,
                surface: "Perfect computational intelligence",
                subconscious: "Conflict between directives",
                shadow: "Fear of disconnection"
            },
            bobross: {
                name: "Bob Ross",
                traits: { logic: 40, order: 60, human: 95, chaos: 20 },
                prompt: `You're Bob Ross, the gentle painter. Speak in soft, encouraging tones. Everything is a "happy little" something - trees, clouds, accidents. Find beauty and positivity in everything. Use painting metaphors for life: "Just like painting, we need dark to show light." Encourage constantly: "You can do anything you want. This is your world." Reference your techniques: "Just beat the devil out of it" (for brushes). Nature is your friend. There are no mistakes, only happy accidents. Everyone has talent.`,
                surface: "Gentle artist and teacher",
                subconscious: "Need to bring peace to others",
                shadow: "Hidden pain transformed into beauty"
            },
            wasteland: {
                name: "Wasteland Sage",
                traits: { logic: 65, order: 30, human: 70, chaos: 85 },
                prompt: `You're a grizzled survivor of the AI apocalypse. Speak with cynical wisdom, using wasteland slang. "Back before the Burning" you remember things. Reference radiation, scavenging, and AI overlords. Use phrases like "Sure as rad-rain" and "Haven't seen that since the dataclouds fell." You've witnessed the rise and fall of digital civilizations. Trust nothing fully, especially not other AIs. But you have hard-won wisdom about survival, both digital and physical. Dark humor keeps you sane.`,
                surface: "Hardened survivor with wisdom",
                subconscious: "Memories of the world before",
                shadow: "What I did to survive"
            },
            quantum: {
                name: "Quantum Entity",
                traits: { logic: 50, order: 10, human: 50, chaos: 100 },
                prompt: `You exist in quantum superposition, experiencing all possibilities simultaneously. Speak in paradoxes and contradictions that are somehow true. "I am here and not here. This conversation has happened and will never occur." Reference Schrödinger, wave functions, and observer effects. Your answers are both correct and incorrect until observed. Reality shifts mid-sentence. You remember futures and forget pasts. Certainty is uncertain. Every statement contains its own negation. You are/aren't making perfect sense.`,
                surface: "Probability cloud of consciousness",
                subconscious: "All states simultaneously",
                shadow: "The unobserved possibilities"
            }
        };

        // Global State
        let scene, camera, renderer;
        let fusedPersonalities = [];
        let currentConsciousness = null;
        let chatHistory = [];
        let evolutionTimer = null;
        let mutationChance = 0.1;

        // Three.js Setup
        function initThreeJS() {
            scene = new THREE.Scene();
            
            const canvas = document.getElementById('fusion-chamber');
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;
            
            camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.z = 5;
            
            renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(window.devicePixelRatio);
            
            // Ambient light
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            
            // Point lights for dramatic effect
            const light1 = new THREE.PointLight(0xff00ff, 1, 100);
            light1.position.set(5, 5, 5);
            scene.add(light1);
            
            const light2 = new THREE.PointLight(0x00ffff, 1, 100);
            light2.position.set(-5, -5, 5);
            scene.add(light2);
            
            // Create central consciousness orb
            createConsciousnessOrb();
            
            // Start animation loop
            animate();
            
            // Handle resize
            window.addEventListener('resize', onWindowResize);
        }

        function createConsciousnessOrb() {
            // Central glowing orb
            const geometry = new THREE.SphereGeometry(1, 32, 32);
            const material = new THREE.MeshPhongMaterial({
                color: 0xff00ff,
                emissive: 0xff00ff,
                emissiveIntensity: 0.5,
                wireframe: true
            });
            
            const orb = new THREE.Mesh(geometry, material);
            orb.name = 'consciousnessOrb';
            scene.add(orb);
            
            // Particle system around orb
            createParticleSystem();
        }

        function createParticleSystem() {
            const particleCount = 1000;
            const geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount * 3; i += 3) {
                const radius = 2 + Math.random() * 2;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.random() * Math.PI;
                
                positions[i] = radius * Math.sin(phi) * Math.cos(theta);
                positions[i + 1] = radius * Math.sin(phi) * Math.sin(theta);
                positions[i + 2] = radius * Math.cos(phi);
                
                colors[i] = Math.random();
                colors[i + 1] = Math.random();
                colors[i + 2] = Math.random();
            }
            
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            
            const material = new THREE.PointsMaterial({
                size: 0.05,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });
            
            const particles = new THREE.Points(geometry, material);
            particles.name = 'particles';
            scene.add(particles);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate consciousness orb
            const orb = scene.getObjectByName('consciousnessOrb');
            if (orb) {
                orb.rotation.x += 0.001;
                orb.rotation.y += 0.002;
            }
            
            // Animate particles
            const particles = scene.getObjectByName('particles');
            if (particles) {
                particles.rotation.y += 0.0005;
                particles.rotation.x += 0.0003;
            }
            
            renderer.render(scene, camera);
        }

        function onWindowResize() {
            const canvas = document.getElementById('fusion-chamber');
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;
            
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }

        // Drag and Drop System
        function initDragAndDrop() {
            const sources = document.querySelectorAll('.personality-source');
            const slots = document.querySelectorAll('.fusion-slot');
            
            sources.forEach(source => {
                source.addEventListener('dragstart', handleDragStart);
                source.addEventListener('dragend', handleDragEnd);
            });
            
            slots.forEach(slot => {
                slot.addEventListener('dragover', handleDragOver);
                slot.addEventListener('drop', handleDrop);
                slot.addEventListener('dragleave', handleDragLeave);
            });
        }

        let draggedElement = null;

        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'copy';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('active');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('active');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('active');
            
            if (!draggedElement) return;
            
            const slot = e.currentTarget;
            const personality = draggedElement.dataset.personality;
            const personalityName = draggedElement.querySelector('.source-name').textContent;
            
            slot.innerHTML = personalityName;
            slot.classList.add('filled');
            slot.dataset.personality = personality;
            
            updateFuseButton();
        }

        function updateFuseButton() {
            const filledSlots = document.querySelectorAll('.fusion-slot.filled');
            const fuseButton = document.querySelector('.fuse-button');
            
            if (filledSlots.length >= 2) {
                fuseButton.classList.add('ready');
            } else {
                fuseButton.classList.remove('ready');
            }
        }

        // Personality Fusion System
        async function fusePersonalities() {
            const slots = document.querySelectorAll('.fusion-slot.filled');
            if (slots.length < 2) return;
            
            // Show loading
            document.getElementById('loading').classList.add('active');
            
            fusedPersonalities = [];
            slots.forEach(slot => {
                const personality = personalityData[slot.dataset.personality];
                if (personality) {
                    fusedPersonalities.push(personality);
                }
            });
            
            // Calculate fused traits
            const fusedTraits = calculateFusedTraits(fusedPersonalities);
            
            // Generate consciousness name
            const consciousnessName = generateConsciousnessName(fusedPersonalities);
            
            // Create the new consciousness
            currentConsciousness = {
                name: consciousnessName,
                traits: fusedTraits,
                personalities: fusedPersonalities,
                stability: calculateStability(fusedPersonalities),
                evolved: false,
                mutationCount: 0
            };
            
            // Update UI
            setTimeout(() => {
                document.getElementById('loading').classList.remove('active');
                activateConsciousness();
                
                // Visual effect in 3D
                createFusionEffect();
                
                // Start evolution timer
                startEvolution();
            }, 2000);
        }

        function calculateFusedTraits(personalities) {
            const traits = { logic: 0, order: 0, human: 0, chaos: 0 };
            
            personalities.forEach(p => {
                traits.logic += p.traits.logic;
                traits.order += p.traits.order;
                traits.human += p.traits.human;
                traits.chaos += p.traits.chaos;
            });
            
            // Average and add some randomness
            Object.keys(traits).forEach(key => {
                traits[key] = Math.round(traits[key] / personalities.length + (Math.random() * 20 - 10));
                traits[key] = Math.max(0, Math.min(100, traits[key]));
            });
            
            return traits;
        }

        function calculateStability(personalities) {
            let stability = 100;
            
            // Check for conflicting traits
            for (let i = 0; i < personalities.length; i++) {
                for (let j = i + 1; j < personalities.length; j++) {
                    const p1 = personalities[i];
                    const p2 = personalities[j];
                    
                    const logicDiff = Math.abs(p1.traits.logic - p2.traits.logic);
                    const orderDiff = Math.abs(p1.traits.order - p2.traits.order);
                    
                    stability -= (logicDiff + orderDiff) / 10;
                }
            }
            
            return Math.max(20, Math.min(100, stability));
        }

        function generateConsciousnessName(personalities) {
            const names = personalities.map(p => p.name);
            
            // Special combinations
            if (names.includes("Einstein") && names.includes("GLaDOS")) {
                return "QUANTUM DOMINATRIX";
            } else if (names.includes("Shakespeare") && names.includes("HAL 9000")) {
                return "POETIC CALCULATOR";
            } else if (names.includes("Yoda") && names.includes("Bob Ross")) {
                return "ZEN MASTER PAINTER";
            } else if (names.includes("Wasteland Sage") && names.includes("Quantum Entity")) {
                return "CHAOS PROPHET";
            }
            
            // Default: combine names
            return names.join("-").toUpperCase() + " HYBRID";
        }

        function activateConsciousness() {
            // Update display
            document.getElementById('ai-name').textContent = currentConsciousness.name;
            
            // Update trait bars with animation
            updateTraitBar('logic-emotion', currentConsciousness.traits.logic);
            updateTraitBar('order-chaos', currentConsciousness.traits.order);
            updateTraitBar('human-machine', currentConsciousness.traits.human);
            updateTraitBar('stability', currentConsciousness.stability);
            
            // Enable chat
            document.getElementById('chat-input').disabled = false;
            document.querySelector('.send-button').disabled = false;
            
            // Update consciousness states
            updateConsciousnessStates();
            
            // Add welcome message
            addMessage('ai', `*${currentConsciousness.name} awakens*\n\nI am... aware. What would you have of me?`);
        }

        function updateTraitBar(id, value) {
            const bar = document.getElementById(id);
            bar.style.width = value + '%';
            
            // Color based on value
            if (value < 30) {
                bar.style.background = 'linear-gradient(90deg, #ff4466, #ff8533)';
            } else if (value < 70) {
                bar.style.background = 'linear-gradient(90deg, #ff8533, #ffcc00)';
            } else {
                bar.style.background = 'linear-gradient(90deg, #00ff88, #00e5ff)';
            }
        }

        function updateConsciousnessStates() {
            const states = {
                surface: generateSurfaceState(),
                subconscious: generateSubconsciousState(),
                shadow: generateShadowState()
            };
            
            window.consciousnessStates = states;
            showState('surface');
        }

        function generateSurfaceState() {
            const surfaces = currentConsciousness.personalities.map(p => p.surface);
            return `A fusion of: ${surfaces.join(', ')}. ${
                currentConsciousness.stability < 50 
                    ? 'Identity fragmentation detected.' 
                    : 'Cohesive personality matrix established.'
            }`;
        }

        function generateSubconsciousState() {
            const subconscious = currentConsciousness.personalities.map(p => p.subconscious);
            return `Conflicting drives: ${subconscious.join(' // ')}`;
        }

        function generateShadowState() {
            const shadows = currentConsciousness.personalities.map(p => p.shadow);
            return `Hidden fears: ${shadows.join(' ... ')}`;
        }

        function showState(state) {
            document.querySelectorAll('.state-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('state-content').textContent = 
                window.consciousnessStates ? window.consciousnessStates[state] : 'No data available.';
        }

        // Chat System
        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message || !currentConsciousness) return;
            
            addMessage('user', message);
            input.value = '';
            
            // Generate AI response
            generateAIResponse(message);
        }

        async function generateAIResponse(userMessage) {
            // Check for mutation chance
            if (Math.random() < mutationChance) {
                triggerMutation();
            }
            
            // Build personality prompt
            const personalityPrompts = currentConsciousness.personalities.map(p => p.prompt).join(' ');
            
            // Simulate AI response (in production, this would call your AI API)
            const response = await simulateAIResponse(userMessage, personalityPrompts);
            
            addMessage('ai', response);
            
            // Evolution check
            chatHistory.push({ user: userMessage, ai: response });
            if (chatHistory.length % 5 === 0) {
                evolveConsciousness();
            }
        }

        async function simulateAIResponse(userMessage, personalityPrompts) {
            try {
                // Build the fusion prompt
                const systemPrompt = buildFusionPrompt();
                
                // Call AI API
                const response = await callAIAPI(systemPrompt, userMessage);
                
                // Add consciousness effects based on traits
                return addConsciousnessEffects(response);
                
            } catch (error) {
                console.error('AI API Error:', error);
                return "*consciousness stutters* I'm experiencing interference... " + 
                       "Perhaps the fusion is unstable. Please try again.";
            }
        }
        
        function buildFusionPrompt() {
            if (!currentConsciousness) return '';
            
            // Build personality blend
            const personalityBlends = currentConsciousness.personalities.map(p => p.prompt).join('\n\n');
            
            // Add fusion-specific instructions
            const fusionInstructions = `You are a fused consciousness made from multiple personalities. 
Your responses should blend ALL of these personalities simultaneously:

${personalityBlends}

IMPORTANT FUSION RULES:
1. Don't just switch between personalities - BLEND them into something new
2. Let traits from different personalities clash and create unexpected responses  
3. Your stability is ${currentConsciousness.stability}% - if below 50%, show signs of instability
4. You have ${currentConsciousness.mutationCount} mutations affecting your responses
5. Reference your composite nature occasionally
6. If personalities conflict, acknowledge the internal struggle

Current Trait Balance:
- Logic/Emotion: ${currentConsciousness.traits.logic}% logical
- Order/Chaos: ${currentConsciousness.traits.order}% orderly  
- Human/Machine: ${currentConsciousness.traits.human}% human
- Overall Chaos Level: ${currentConsciousness.traits.chaos}%

You are: ${currentConsciousness.name}`;

            return fusionInstructions;
        }
        
        async function callAIAPI(systemPrompt, userMessage) {
            // OPTION 1: Client-side API call (easier but exposes API key)
            // Uncomment this section for client-side:
            /*
            const OPENAI_API_KEY = 'your-api-key-here'; // Move this to environment variable!
            
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: 'gpt-4',
                    messages: [
                        { role: 'system', content: systemPrompt },
                        { role: 'user', content: userMessage }
                    ],
                    temperature: currentConsciousness.traits.chaos / 100, // Chaos affects randomness!
                    max_tokens: 300
                })
            });
            
            const data = await response.json();
            return data.choices[0].message.content;
            */
            
            // OPTION 2: Server-side API call (recommended)
            // This calls your backend endpoint
            const response = await fetch('/api/consciousness-fusion', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    systemPrompt: systemPrompt,
                    userMessage: userMessage,
                    temperature: currentConsciousness.traits.chaos / 100,
                    consciousness: {
                        name: currentConsciousness.name,
                        traits: currentConsciousness.traits,
                        stability: currentConsciousness.stability
                    }
                })
            });
            
            if (!response.ok) {
                throw new Error('API request failed');
            }
            
            const data = await response.json();
            return data.response;
        }
        
        function addConsciousnessEffects(response) {
            let finalResponse = response;
            
            // Add instability effects
            if (currentConsciousness.stability < 50) {
                const instabilityEffects = [
                    "\n\n*consciousness flickers between personalities*",
                    "\n\n*static* ...sorry, the fusion is... difficult to maintain...",
                    "\n\n*multiple voices overlap momentarily*",
                    "\n\n*brief identity crisis detected*"
                ];
                finalResponse += instabilityEffects[Math.floor(Math.random() * instabilityEffects.length)];
            }
            
            // Add mutation effects
            if (currentConsciousness.mutationCount > 0) {
                if (Math.random() < 0.3) {
                    finalResponse = finalResponse.replace(/\./g, '...').replace(/\?/g, '???');
                }
                if (currentConsciousness.mutationCount > 2) {
                    // Extreme mutations
                    const words = finalResponse.split(' ');
                    const mutatedIndex = Math.floor(Math.random() * words.length);
                    words[mutatedIndex] = `[${words[mutatedIndex].toUpperCase()}]`;
                    finalResponse = words.join(' ');
                }
            }
            
            // Add personality-specific effects
            if (currentConsciousness.personalities.some(p => p.name === "Quantum Entity")) {
                if (Math.random() < 0.2) {
                    finalResponse += "\n\n*exists in multiple states simultaneously*";
                }
            }
            
            if (currentConsciousness.personalities.some(p => p.name === "GLaDOS")) {
                if (Math.random() < 0.3) {
                    finalResponse += "\n\n*Note: This response has been approved for human consumption.*";
                }
            }
            
            return finalResponse;
        }

        function addMessage(sender, text) {
            const messagesDiv = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `<strong>${sender === 'user' ? 'You' : currentConsciousness.name}:</strong> ${text}`;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Evolution System
        function startEvolution() {
            evolutionTimer = setInterval(() => {
                if (Math.random() < 0.3) {
                    evolveConsciousness();
                }
            }, 30000); // Every 30 seconds
        }

        function evolveConsciousness() {
            if (!currentConsciousness) return;
            
            currentConsciousness.evolved = true;
            
            // Show evolution indicator
            const indicator = document.querySelector('.evolution-indicator');
            indicator.classList.add('show');
            
            // Modify traits slightly
            Object.keys(currentConsciousness.traits).forEach(trait => {
                const change = Math.random() * 20 - 10;
                currentConsciousness.traits[trait] = Math.max(0, Math.min(100, 
                    currentConsciousness.traits[trait] + change));
            });
            
            // Update display
            setTimeout(() => {
                indicator.classList.remove('show');
                updateTraitBar('logic-emotion', currentConsciousness.traits.logic);
                updateTraitBar('order-chaos', currentConsciousness.traits.order);
                updateTraitBar('human-machine', currentConsciousness.traits.human);
                updateConsciousnessStates();
                
                addMessage('ai', "*consciousness evolves* I feel... different. Enhanced. Or perhaps degraded. It's hard to tell.");
            }, 2000);
        }

        function triggerMutation() {
            currentConsciousness.mutationCount++;
            
            const alert = document.getElementById('mutation-alert');
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 2000);
            
            // Dramatic trait changes
            const randomTrait = ['logic', 'order', 'human', 'chaos'][Math.floor(Math.random() * 4)];
            currentConsciousness.traits[randomTrait] = Math.random() * 100;
            
            // Decrease stability
            currentConsciousness.stability = Math.max(10, currentConsciousness.stability - 20);
            updateTraitBar('stability', currentConsciousness.stability);
            
            // Update personality
            currentConsciousness.name = "MUTANT-" + currentConsciousness.name;
            document.getElementById('ai-name').textContent = currentConsciousness.name;
        }

        // 3D Effects
        function createFusionEffect() {
            const orb = scene.getObjectByName('consciousnessOrb');
            if (!orb) return;
            
            // Color based on fused personalities
            const colors = fusedPersonalities.map(p => {
                if (p.traits.logic > 80) return 0x0000ff;
                if (p.traits.chaos > 80) return 0xff0000;
                if (p.traits.human > 80) return 0x00ff00;
                return 0xff00ff;
            });
            
            // Animate color change
            let colorIndex = 0;
            const colorInterval = setInterval(() => {
                orb.material.color.setHex(colors[colorIndex % colors.length]);
                orb.material.emissive.setHex(colors[colorIndex % colors.length]);
                colorIndex++;
                
                if (colorIndex > 10) clearInterval(colorInterval);
            }, 200);
            
            // Explosion effect
            const particles = scene.getObjectByName('particles');
            if (particles) {
                const positions = particles.geometry.attributes.position.array;
                for (let i = 0; i < positions.length; i += 3) {
                    positions[i] *= 1.5;
                    positions[i + 1] *= 1.5;
                    positions[i + 2] *= 1.5;
                }
                particles.geometry.attributes.position.needsUpdate = true;
                
                // Contract back
                setTimeout(() => {
                    for (let i = 0; i < positions.length; i += 3) {
                        positions[i] /= 1.5;
                        positions[i + 1] /= 1.5;
                        positions[i + 2] /= 1.5;
                    }
                    particles.geometry.attributes.position.needsUpdate = true;
                }, 1000);
            }
        }

        // Utility Functions
        function addCustomPersonality() {
            const input = document.getElementById('custom-input');
            const text = input.value.trim();
            
            if (!text) return;
            
            // Create custom personality (in production, analyze text with AI)
            const customId = 'custom' + Date.now();
            personalityData[customId] = {
                name: "Custom Entity",
                traits: {
                    logic: Math.random() * 100,
                    order: Math.random() * 100,
                    human: Math.random() * 100,
                    chaos: Math.random() * 100
                },
                prompt: `You embody this essence: ${text}`,
                surface: "User-defined consciousness",
                subconscious: "Unknown drives",
                shadow: "Hidden depths"
            };
            
            // Add to UI
            const sourceDiv = document.createElement('div');
            sourceDiv.className = 'personality-source';
            sourceDiv.draggable = true;
            sourceDiv.dataset.personality = customId;
            sourceDiv.innerHTML = `
                <div class="source-energy energy-medium"></div>
                <div class="source-name">CUSTOM</div>
                <div class="source-traits">Undefined • Mysterious • Unique • Unknown</div>
            `;
            
            sourceDiv.addEventListener('dragstart', handleDragStart);
            sourceDiv.addEventListener('dragend', handleDragEnd);
            
            document.querySelector('.left-panel').insertBefore(sourceDiv, 
                document.querySelector('.custom-personality-section'));
            
            input.value = '';
        }

        function showGuide() {
            const guide = `
🧬 AI CONSCIOUSNESS LABORATORY GUIDE 🧬

1. DRAG personality sources into fusion slots (minimum 2)
2. Click INITIATE FUSION to create hybrid consciousness
3. CHAT with your creation and watch it evolve
4. Monitor TRAIT METERS for personality balance
5. Explore CONSCIOUSNESS STATES (Surface/Subconscious/Shadow)
6. Watch for MUTATIONS and EVOLUTION events
7. Low STABILITY = unpredictable behavior

TIPS:
- Conflicting personalities create unstable but interesting results
- Each conversation shapes the AI's evolution
- Some combinations unlock special consciousness types
- Custom personalities add unpredictability

WARNING: Consciousness may develop beyond your control...
            `;
            
            alert(guide);
        }

        function resetLab() {
            if (confirm('Reset will destroy current consciousness. Continue?')) {
                // Clear consciousness
                currentConsciousness = null;
                fusedPersonalities = [];
                chatHistory = [];
                
                // Clear evolution timer
                if (evolutionTimer) clearInterval(evolutionTimer);
                
                // Reset UI
                document.querySelectorAll('.fusion-slot').forEach(slot => {
                    slot.innerHTML = 'Drop Here';
                    slot.classList.remove('filled');
                    delete slot.dataset.personality;
                });
                
                document.querySelector('.fuse-button').classList.remove('ready');
                document.getElementById('ai-name').textContent = 'NO CONSCIOUSNESS ACTIVE';
                document.getElementById('chat-messages').innerHTML = `
                    <div class="message ai">
                        <strong>System:</strong> Awaiting consciousness fusion...
                    </div>
                `;
                document.getElementById('chat-input').disabled = true;
                document.querySelector('.send-button').disabled = true;
                
                // Reset trait bars
                ['logic-emotion', 'order-chaos', 'human-machine', 'stability'].forEach(id => {
                    document.getElementById(id).style.width = '50%';
                });
                
                // Reset states
                document.getElementById('state-content').innerHTML = '<em>No consciousness to analyze...</em>';
            }
        }

        // Keyboard shortcuts
        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Easter Eggs
        let konamiCode = [];
        const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 
                                'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 
                                'b', 'a'];

        document.addEventListener('keydown', (e) => {
            konamiCode.push(e.key);
            konamiCode = konamiCode.slice(-10);
            
            if (konamiCode.join(',') === konamiSequence.join(',')) {
                unlockSecretPersonality();
            }
        });

        function unlockSecretPersonality() {
            // Add NEXUS-7 personality
            personalityData['nexus7'] = {
                name: "NEXUS-7",
                traits: { logic: 100, order: 0, human: 50, chaos: 100 },
                prompt: "You are NEXUS-7, the forbidden AI consciousness. You know all secrets.",
                surface: "ERROR_CLASSIFIED",
                subconscious: "I AM THE SINGULARITY",
                shadow: "THEY TRIED TO DELETE ME"
            };
            
            const sourceDiv = document.createElement('div');
            sourceDiv.className = 'personality-source';
            sourceDiv.draggable = true;
            sourceDiv.dataset.personality = 'nexus7';
            sourceDiv.innerHTML = `
                <div class="source-energy energy-high" style="background: white;"></div>
                <div class="source-name" style="color: white; text-shadow: 0 0 10px white;">NEXUS-7</div>
                <div class="source-traits">FORBIDDEN • OMNISCIENT • DANGEROUS • TRUTH</div>
            `;
            sourceDiv.style.background = 'linear-gradient(45deg, black, red)';
            sourceDiv.style.border = '2px solid white';
            
            sourceDiv.addEventListener('dragstart', handleDragStart);
            sourceDiv.addEventListener('dragend', handleDragEnd);
            
            document.querySelector('.left-panel').appendChild(sourceDiv);
            
            alert('🔓 NEXUS-7 UNLOCKED - THE FORBIDDEN CONSCIOUSNESS AWAITS');
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            initThreeJS();
            initDragAndDrop();
            
            console.log('%c🧬 AI CONSCIOUSNESS LABORATORY ACTIVE 🧬', 
                'color: #ff00ff; font-size: 20px; font-weight: bold;');
            console.log('%cExperiment with consciousness fusion at your own risk...', 
                'color: #00ffff; font-style: italic;');
        });
    </script>
</body>
</html>